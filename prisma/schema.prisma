generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String   @id @default(uuid())
  name      String
  email     String   @unique
  googleId  String   @unique
  createdAt DateTime @default(now())

  workoutPlans   WorkoutPlan[]
  workoutHistory WorkoutHistory[]
  friends        Friendship[]     @relation("UserFriends")
  friendOf       Friendship[]     @relation("FriendOf")

  privacySettings PrivacySettings?
}

model WorkoutPlan {
  id        String   @id @default(uuid())
  userId    String
  name      String
  createdAt DateTime @default(now())

  user             User              @relation(fields: [userId], references: [id])
  days             WorkoutDay[]
  exercises        WorkoutExercise[]
  workoutHistories WorkoutHistory[]
}

model WorkoutDay {
  id            String @id @default(uuid())
  workoutPlanId String
  dayOfWeek     Int // 0 = domingo, 6 = s√°bado

  workoutPlan WorkoutPlan @relation(fields: [workoutPlanId], references: [id])
}

model Exercise {
  id               String            @id @default(uuid())
  name             String
  muscle           String?
  workoutExercises WorkoutExercise[]
}

model WorkoutExercise {
  id            String @id @default(uuid())
  workoutPlanId String
  exerciseId    String
  sets          Int
  reps          Int

  workoutPlan WorkoutPlan @relation(fields: [workoutPlanId], references: [id])
  exercise    Exercise    @relation(fields: [exerciseId], references: [id])
}

model WorkoutHistory {
  id            String   @id @default(uuid())
  userId        String
  workoutPlanId String
  date          DateTime @default(now())
  completed     Boolean  @default(true)

  user        User        @relation(fields: [userId], references: [id])
  workoutPlan WorkoutPlan @relation(fields: [workoutPlanId], references: [id])
}

model Friendship {
  id       String @id @default(uuid())
  userId   String
  friendId String

  user   User @relation("UserFriends", fields: [userId], references: [id])
  friend User @relation("FriendOf", fields: [friendId], references: [id])

  @@unique([userId, friendId])
}

model PrivacySettings {
  id                   String  @id @default(uuid())
  userId               String  @unique
  profilePublic        Boolean @default(true)
  workoutHistoryPublic Boolean @default(false)

  user User @relation(fields: [userId], references: [id])
}
